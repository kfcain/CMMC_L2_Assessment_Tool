// Part 1: AC, AT, AU controls
const D1 = {};

D1["3.1.1e"] = {
aws:{svc:["AWS IAM","AWS Organizations SCPs","AWS Systems Manager Change Manager","AWS CloudTrail","AWS Step Functions"],st:["Configure Systems Manager Change Manager requiring two approvers for critical changes","Implement IAM policies requiring MFA plus second approver for destructive actions","Deploy Step Functions workflows enforcing dual-approval gates for sensitive operations","Create Organizations SCPs preventing single-user execution of critical operations","Enable CloudTrail with integrity validation to log all dual-authorization events"],cli:"# Change Manager with 2 approvers\naws ssm create-document --name DualApprovalChange \\\n  --document-type Automation --content file://dual-approval.json",cost:"$50-200/month",hrs:24},
azure:{svc:["Azure PIM","Entra ID Privileged Access Groups","Azure Policy","Microsoft Purview","Azure Monitor"],st:["Configure PIM role activation requiring approval from two separate administrators","Create Privileged Access Groups with multiple owners for sensitive operations","Deploy Azure Policy denying resource deletion without dual-approval tag","Implement Purview dual-key encryption for highly sensitive CUI data","Set up Azure Monitor alerts for any bypass of dual-authorization controls"],cost:"$100-400/month (Entra ID P2)",hrs:20},
gcp:{svc:["Access Approval","Cloud IAM Conditions","Organization Policy","Cloud Functions","Cloud Audit Logs"],st:["Enable Access Approval requiring two authorized individuals for resource access","Configure IAM Conditions requiring second-party approval token","Deploy Organization Policy constraints preventing single-user critical operations","Implement Cloud Functions workflow enforcing dual-approval for sensitive API calls","Enable Cloud Audit Logs for all administrative and dual-authorization activities"],cost:"$50-150/month",hrs:18},
pa:{svc:["Panorama","PAN-OS Role-Based Admin","Configuration Locking","Audit Logging"],st:["Configure Panorama dual-admin commit approval requiring two administrators","Implement configuration locking so second admin must approve before commit","Set up role-based administration separating policy creation from approval","Enable comprehensive audit logging for all configuration changes","Deploy Panorama commit approval workflows for all device groups"],cost:"Included with Panorama license",hrs:12},
s1:{svc:["Singularity XDR","RBAC","Policy Management","Audit Trail"],st:["Configure SentinelOne RBAC with separation of duties for critical actions","Implement approval workflows for policy changes affecting CUI endpoints","Enable two-person integrity for threat response actions (quarantine, remediate)","Set up audit trail monitoring for all administrative changes","Configure notification alerts requiring second approval for security policy modifications"],cost:"Included with Singularity Complete",hrs:10},
ninja:{svc:["NinjaOne RMM","Role-Based Access","Approval Workflows","Activity Log"],st:["Configure NinjaOne roles with separation of duties for critical operations","Implement approval requirements for script execution on CUI systems","Set up dual-authorization for remote access to sensitive endpoints","Enable comprehensive activity logging for all administrative actions","Configure alerts for policy changes affecting CUI device groups"],cost:"Included with NinjaOne license",hrs:8},
ten:{svc:["Tenable.io","Role-Based Access","Scan Policies","Audit Logging"],st:["Configure Tenable.io RBAC with dual-authorization for scan policy changes","Implement approval workflows for vulnerability exception requests","Set up separation of duties between scan operators and remediation approvers","Enable audit logging for all scan configuration and exception changes","Configure alerts for unauthorized scan policy modifications"],cost:"Included with Tenable.io license",hrs:8}
};

D1["3.1.2e"] = {
aws:{svc:["AWS IAM","AWS VPC","AWS PrivateLink","AWS Resource Access Manager","AWS SCPs"],st:["Implement explicit-deny IAM policies blocking access to non-organization-owned resources","Deploy VPC endpoints restricting service access to organization-provisioned VPCs only","Configure PrivateLink limited to organization-approved services","Use Resource Access Manager with explicit sharing for org-owned resources only","Create SCPs preventing use of personal accounts or non-org AWS services"],cost:"$25-100/month",hrs:20},
azure:{svc:["Azure RBAC","Azure Private Link","Azure Policy","Management Groups","Entra ID"],st:["Implement deny-by-default RBAC with explicit assignments to org-owned resources only","Deploy Private Endpoints restricting access to organization-provisioned services","Configure Azure Policy denying resource creation outside org-managed subscriptions","Set up Management Groups with restrictive policy inheritance","Block personal Microsoft accounts via Entra ID tenant restrictions"],cost:"$50-200/month",hrs:18},
gcp:{svc:["Cloud IAM","VPC Service Controls","Organization Policy","Resource Manager","Private Google Access"],st:["Implement VPC Service Controls perimeters restricting to org-owned projects only","Configure Organization Policy constraints blocking non-org resource access","Deploy IAM deny policies preventing access to resources outside the organization","Enable Private Google Access limited to org-approved services","Use Resource Manager to enforce org-level resource ownership policies"],cost:"$50-150/month",hrs:16},
pa:{svc:["PAN-OS Security Policies","App-ID","User-ID","URL Filtering","Zone Protection"],st:["Implement zero-trust policies allowing only org-owned destination resources","Configure App-ID restricting applications to organization-approved list","Deploy User-ID mapping enforcing user-to-org-resource authorization","Enable URL Filtering blocking access to non-organization web resources","Set up Zone Protection profiles isolating org-owned network segments"],cost:"Included with NGFW license",hrs:16},
s1:{svc:["Singularity XDR","Firewall Control","Device Control","Network Control"],st:["Configure Firewall Control restricting endpoint connections to org-owned resources","Implement Device Control blocking unauthorized USB/peripheral from non-org devices","Deploy Network Control limiting communications to org-provisioned systems","Set up application control preventing access to non-org cloud services","Enable Deep Visibility monitoring for non-org resource access attempts"],cost:"Included with Singularity Complete",hrs:12},
ninja:{svc:["NinjaOne RMM","Policy Management","Software Restrictions","Monitoring"],st:["Configure policies restricting software to org-provisioned applications","Implement device group policies limiting access to org-owned resources only","Deploy monitoring alerts for access to non-organization resources","Set up automated remediation removing non-org software and connections","Configure endpoint firewall rules allowing only org-owned destinations"],cost:"Included with NinjaOne license",hrs:10},
ten:{svc:["Tenable.io","Tenable.ad","Asset Discovery","Compliance Auditing"],st:["Deploy asset discovery to identify all resources and flag non-org-owned assets","Configure compliance audits verifying only org-provisioned resources in use","Use Tenable.ad to detect non-org accounts and unauthorized resource grants","Implement continuous monitoring for new non-org resource connections","Create dashboards comparing discovered assets against org-owned inventory"],cost:"Included with Tenable.io license",hrs:10}
};

D1["3.1.3e"] = {
aws:{svc:["AWS Network Firewall","AWS Macie","VPC Flow Logs","AWS PrivateLink","S3 Block Public Access"],st:["Deploy Network Firewall with stateful rules blocking unauthorized CUI egress","Configure Macie to discover, classify, and monitor CUI data flows in S3","Enable VPC Flow Logs with analysis for detecting anomalous data transfers","Implement PrivateLink for all CUI data transfers between services","Enforce S3 Block Public Access and bucket policies preventing CUI exfiltration"],cost:"$200-800/month",hrs:28},
azure:{svc:["Azure Firewall Premium","Microsoft Purview DLP","Azure Information Protection","NSG Flow Logs","Private Link"],st:["Deploy Azure Firewall Premium with IDPS and TLS inspection for CUI traffic","Configure Purview DLP policies to detect and block CUI exfiltration attempts","Implement Azure Information Protection labels for CUI classification and flow control","Enable NSG Flow Logs with Traffic Analytics for anomalous transfer detection","Use Private Link for all CUI data transfers between Azure services"],cost:"$300-1200/month",hrs:26},
gcp:{svc:["VPC Service Controls","Cloud DLP","Cloud Armor","VPC Flow Logs","Cloud NAT"],st:["Implement VPC Service Controls perimeters preventing CUI data exfiltration","Deploy Cloud DLP to discover, classify, and restrict CUI data flows","Configure Cloud Armor policies blocking unauthorized data egress","Enable VPC Flow Logs for monitoring all CUI network traffic patterns","Use Cloud NAT with restricted egress for CUI workloads"],cost:"$200-800/month",hrs:24},
pa:{svc:["PAN-OS DLP","App-ID","SSL Decryption","Zone Protection","WildFire"],st:["Configure PAN-OS Data Filtering profiles to detect and block CUI exfiltration","Deploy App-ID with SSL Decryption to inspect encrypted CUI data flows","Implement zone-based policies restricting CUI flow to authorized paths only","Enable WildFire for detecting malware-based exfiltration attempts","Set up file blocking profiles preventing unauthorized CUI file transfers"],cost:"$500-2000/month",hrs:20},
s1:{svc:["Singularity XDR","Firewall Control","Device Control","Deep Visibility","STAR Rules"],st:["Configure Firewall Control restricting CUI endpoint egress to authorized destinations","Implement Device Control blocking USB and removable media on CUI endpoints","Deploy STAR rules detecting bulk data transfer and exfiltration patterns","Enable Deep Visibility for monitoring file operations and network connections","Set up automated response to isolate endpoints exhibiting exfiltration behavior"],cost:"Included with Singularity Complete",hrs:14},
ninja:{svc:["NinjaOne RMM","Policy Management","Monitoring","Scripting"],st:["Deploy policies disabling USB storage on CUI endpoints","Configure monitoring for large file transfers from CUI systems","Implement scripts to audit and restrict cloud storage sync clients","Set up alerts for unauthorized applications that could exfiltrate data","Create endpoint firewall rules restricting CUI egress paths"],cost:"Included with NinjaOne license",hrs:10},
ten:{svc:["Tenable.io","Compliance Auditing","Network Scanning"],st:["Deploy compliance audits verifying DLP and exfiltration controls in place","Configure network scans identifying unauthorized egress paths from CUI segments","Scan for misconfigured services that could allow CUI data leakage","Implement continuous monitoring for new paths bypassing flow controls","Create dashboards tracking CUI flow control compliance"],cost:"Included with Tenable.io license",hrs:10}
};

D1["3.2.1e"] = {
aws:{svc:["AWS Security Hub","Amazon GuardDuty","CloudTrail Insights","Amazon Detective"],st:["Use GuardDuty findings as real-world APT training examples for cloud threats","Create training scenarios from CloudTrail Insights anomalous activity patterns","Develop role-based training using Security Hub dashboards and finding categories","Build tabletop exercises around Detective investigation workflows","Integrate AWS threat intelligence into quarterly APT awareness briefings"],cost:"$500-2000/year",hrs:40},
azure:{svc:["Attack Simulation Training","Microsoft Defender XDR","Microsoft Sentinel","Microsoft Learn"],st:["Deploy Attack Simulation Training with APT-style spear-phishing campaigns","Use Defender XDR real incident examples for APT awareness training","Configure Sentinel workbooks as training dashboards for threat indicators","Create role-based learning paths using Microsoft Learn security modules","Implement automated training assignments based on simulation failure results"],cost:"Included with M365 E5",hrs:36},
gcp:{svc:["Security Command Center","Chronicle","Cloud Audit Logs","Mandiant Threat Intelligence"],st:["Use SCC findings as training examples for cloud-specific APT indicators","Leverage Chronicle and Mandiant threat intelligence for training content","Create training scenarios based on Cloud Audit Log anomalies","Develop GCP-specific APT awareness modules covering cloud attack vectors","Integrate MITRE ATT&CK cloud matrix into training curriculum"],cost:"$500-2000/year",hrs:36},
s1:{svc:["Singularity XDR","Deep Visibility","Threat Intelligence","Storyline"],st:["Use SentinelOne threat intelligence reports as APT training content","Create training exercises using Deep Visibility query examples","Develop incident response training from real Storyline attack chains","Train SOC staff on STAR custom detection rule creation for APT indicators","Implement tabletop exercises using SentinelOne alert scenarios"],cost:"Included with Singularity license",hrs:20},
ninja:{svc:["NinjaOne RMM","Documentation","Ticketing","Scripting"],st:["Maintain APT awareness training materials in NinjaOne knowledge base","Create training completion tickets for tracking and assessment","Deploy automated training reminder scripts via NinjaOne","Monitor endpoint security posture as training effectiveness metric","Document training curriculum updates and version history"],cost:"Included with NinjaOne license",hrs:12},
ten:{svc:["Tenable.io","Vulnerability Reports","Compliance Dashboards"],st:["Use vulnerability trend reports as training material for threat awareness","Create training on interpreting VPR scores and threat prioritization","Develop exercises on compliance audit result analysis and remediation","Train staff on vulnerability remediation workflows and timelines","Integrate Tenable findings into security awareness curriculum"],cost:"Included with Tenable.io license",hrs:10}
};

D1["3.2.2e"] = {
aws:{svc:["AWS GameDay","Amazon GuardDuty","AWS Fault Injection Simulator"],st:["Conduct AWS GameDay exercises simulating APT cloud compromise scenarios","Use GuardDuty sample findings for hands-on incident response drills","Deploy Fault Injection Simulator for resilience testing exercises","Create purple team exercises using AWS security services as detection targets","Implement quarterly tabletop exercises with cloud-specific APT scenarios"],cost:"$1000-5000/exercise",hrs:40},
azure:{svc:["Attack Simulation Training","Microsoft Sentinel","Defender XDR"],st:["Deploy Attack Simulation Training with progressively sophisticated phishing","Create Sentinel-based incident response exercises with real-world scenarios","Conduct Defender XDR purple team exercises testing detection capabilities","Implement monthly phishing simulations with individual feedback and coaching","Run quarterly tabletop exercises using documented APT campaign scenarios"],cost:"Included with M365 E5",hrs:36},
gcp:{svc:["Chronicle","Security Command Center","Cloud Functions","Mandiant"],st:["Create tabletop exercises using Chronicle threat detection scenarios","Develop SCC-based incident response drills with realistic findings","Implement automated exercise scenarios using Cloud Functions","Engage Mandiant for red team exercises targeting GCP infrastructure","Run quarterly incident response exercises with individual performance feedback"],cost:"$1000-5000/exercise",hrs:36},
s1:{svc:["Singularity XDR","Storyline","STAR Rules","Deep Visibility"],st:["Create red team exercises validating SentinelOne detection capabilities","Develop incident response drills using Storyline investigation workflows","Implement STAR rule testing exercises for detection engineering training","Conduct purple team exercises measuring endpoint detection coverage gaps","Run tabletop exercises using real SentinelOne alert scenarios with feedback"],cost:"Included with Singularity license",hrs:24}
};

D1["3.3.1e"] = {
aws:{svc:["Amazon Security Lake","Amazon Detective","CloudTrail Lake","Amazon OpenSearch","AWS Lambda"],st:["Deploy Security Lake for centralized log aggregation in OCSF format across all accounts","Configure Detective for automated investigation and cross-account correlation","Implement CloudTrail Lake for SQL-based audit log analysis and correlation","Deploy OpenSearch with correlation dashboards for real-time multi-source analysis","Create Lambda-based automated correlation rules for multi-stage APT detection"],cost:"$200-1000/month",hrs:32},
azure:{svc:["Microsoft Sentinel","Log Analytics","UEBA","Fusion Detection","Data Connectors"],st:["Deploy Sentinel with data connectors for all Azure, M365, and third-party sources","Enable UEBA for behavioral correlation across users, devices, and entities","Configure Fusion detection for automated multi-stage attack correlation","Create custom analytics rules correlating events across identity, endpoint, and network","Implement workbooks providing correlated audit review and executive reporting"],cost:"$300-1500/month",hrs:28},
gcp:{svc:["Chronicle SIEM","Cloud Logging","Security Command Center","BigQuery","Pub/Sub"],st:["Deploy Chronicle SIEM for enterprise-wide log correlation and threat detection","Configure Cloud Logging export to Chronicle for all GCP services via Pub/Sub","Implement SCC Premium for automated finding correlation across projects","Use BigQuery for advanced cross-source audit log analysis and correlation","Create YARA-L detection rules for APT-specific multi-stage correlation"],cost:"$500-2000/month",hrs:30},
pa:{svc:["Cortex Data Lake","Panorama","Cortex XSIAM","Syslog Forwarding"],st:["Deploy Cortex Data Lake for centralized firewall log aggregation and analysis","Configure Panorama log forwarding to enterprise SIEM for cross-source correlation","Implement Cortex XSIAM for AI-driven correlation across network and endpoint","Create correlation rules linking firewall events with identity and endpoint data","Set up automated alerting for correlated multi-stage network attack patterns"],cost:"$500-3000/month (Cortex)",hrs:24},
s1:{svc:["Singularity XDR","Storyline","Deep Visibility","STAR Rules","Data Lake"],st:["Configure Singularity XDR for cross-source event correlation (endpoint, cloud, identity)","Implement Storyline for automated attack chain visualization and correlation","Create STAR custom detection rules correlating events across multiple data sources","Deploy Deep Visibility queries for proactive threat hunting across correlated data","Integrate SentinelOne Data Lake with enterprise SIEM for comprehensive correlation"],cost:"Included with Singularity Complete/XDR",hrs:20},
ninja:{svc:["NinjaOne RMM","Activity Log","Monitoring","Scripting","API"],st:["Configure NinjaOne activity log export to enterprise SIEM via API for correlation","Implement monitoring conditions that feed correlated alerts to SOC","Deploy scripts to collect and forward endpoint audit data for cross-source analysis","Set up automated alerts for activities correlated with security events","Create dashboards correlating RMM activity with security incidents"],cost:"Included with NinjaOne license",hrs:14},
ten:{svc:["Tenable.io","Tenable.sc","VPR","Asset Criticality","API Integration"],st:["Configure Tenable.io API export of vulnerability data to SIEM for correlation","Implement VPR-based correlation between vulnerabilities and active threat intelligence","Deploy asset criticality ratings to prioritize correlated security findings","Create correlation dashboards linking vulnerability exposure to active threats","Integrate Tenable findings with incident response and SOC workflows"],cost:"Included with Tenable.io license",hrs:16}
};

D1["3.3.2e"] = {
aws:{svc:["AWS Security Hub","Amazon GuardDuty","AWS CloudWatch","Amazon EventBridge","AWS Organizations"],st:["Deploy Security Hub with cross-account aggregation as centralized review platform","Configure GuardDuty across all accounts with delegated administrator","Implement CloudWatch cross-account log aggregation for centralized analysis","Deploy EventBridge for real-time security event routing from all components","Create centralized SOC dashboards aggregating findings from all AWS accounts"],cost:"$500-3000/month",hrs:40},
azure:{svc:["Microsoft Sentinel","Azure Lighthouse","Log Analytics","Azure Monitor","Defender XDR"],st:["Deploy centralized Sentinel workspace with cross-tenant data collection","Configure Azure Lighthouse for multi-tenant centralized audit review","Implement Log Analytics workspace linking for centralized query capability","Set up Azure Monitor with centralized alerting across all subscriptions","Deploy Defender XDR for unified security operations across M365 and Azure"],cost:"$1000-5000/month",hrs:40},
gcp:{svc:["Chronicle SIEM","Chronicle SOAR","Cloud Logging","Security Command Center","Cloud Monitoring"],st:["Deploy Chronicle SIEM as centralized audit review and analysis platform","Configure Chronicle SOAR for automated response from centralized review","Implement organization-level Cloud Logging for centralized log collection","Enable SCC organization-level findings for centralized security review","Create Cloud Monitoring dashboards for centralized operational visibility"],cost:"$1000-5000/month",hrs:40},
s1:{svc:["Singularity XDR","Vigilance MDR","Storyline","Remote Shell"],st:["Deploy Singularity XDR console as centralized endpoint audit review platform","Consider Vigilance MDR for 24/7 centralized monitoring and review","Configure multi-site/multi-tenant management for centralized visibility","Implement Storyline for centralized investigation across all endpoints","Create custom dashboards for centralized audit record analysis"],cost:"$5-15/endpoint/month (Vigilance MDR)",hrs:20},
ninja:{svc:["NinjaOne RMM","Multi-Tenant Dashboard","Monitoring","Reporting"],st:["Configure NinjaOne multi-tenant dashboard for centralized endpoint visibility","Implement centralized monitoring policies across all managed organizations","Deploy centralized reporting for audit record review across all endpoints","Set up centralized alerting for security events from all components","Create executive dashboards for centralized compliance review"],cost:"Included with NinjaOne license",hrs:16}
};

module.exports = D1;
