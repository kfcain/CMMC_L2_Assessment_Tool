// Part 2: CM, IA, IR, RA, SC, SI controls
const D2 = {};

D2["3.4.1e"] = {
aws:{svc:["AWS CodeArtifact","Amazon ECR","AWS Signer","AWS Inspector","AWS CodeBuild"],st:["Deploy CodeArtifact as authoritative package repository for all approved software","Configure ECR with image signing via AWS Signer for container integrity","Implement Inspector for continuous vulnerability scanning of repository components","Create CodeBuild pipelines generating SBOMs for all deployed artifacts","Enforce IAM policies requiring all deployments source from approved repositories"],cost:"$50-200/month",hrs:24},
azure:{svc:["Azure Artifacts","Azure Container Registry","GitHub Advanced Security","Azure Policy","Azure DevOps"],st:["Deploy Azure Artifacts as authoritative package feed for all approved software","Configure Container Registry with content trust (Docker Content Trust signing)","Implement GitHub Advanced Security for dependency scanning and SBOM generation","Deploy Azure Policy restricting container images to approved registry only","Create Azure DevOps pipelines with mandatory security scanning gates"],cost:"$50-300/month",hrs:22},
gcp:{svc:["Artifact Registry","Binary Authorization","Container Analysis","Cloud Build","Cloud Deploy"],st:["Deploy Artifact Registry as authoritative component repository for all artifacts","Configure Binary Authorization requiring attestation for container deployments","Implement Container Analysis for automated vulnerability scanning of artifacts","Create Cloud Build pipelines with mandatory attestation and SBOM generation","Enforce deployment policies requiring artifacts from approved registry only"],cost:"$50-200/month",hrs:20},
s1:{svc:["Singularity XDR","Application Inventory","Deep Visibility","STAR Rules"],st:["Use Application Inventory as continuous audit of installed software components","Configure Deep Visibility detecting installation of unapproved components","Implement STAR rules alerting on execution of binaries not in authoritative source","Create automated reports comparing installed software against approved list","Monitor for supply chain attack indicators via XDR correlation"],cost:"Included with Singularity Complete",hrs:12},
ninja:{svc:["NinjaOne RMM","Software Inventory","Patch Management","Documentation"],st:["Use NinjaOne Software Inventory as authoritative record of installed components","Configure automated alerts for software not in approved list","Implement patch management sourcing updates from approved repositories only","Deploy scripts verifying software integrity via hash comparison","Document authoritative component list and approval process in knowledge base"],cost:"Included with NinjaOne license",hrs:10},
ten:{svc:["Tenable.io","Software Composition Analysis","Asset Inventory","Compliance Auditing"],st:["Deploy Tenable.io for comprehensive software component inventory across all systems","Configure vulnerability scans identifying unauthorized or vulnerable components","Implement continuous monitoring detecting new component installations","Create compliance policies verifying only authoritative-source components present","Set up dashboards tracking component authorization compliance enterprise-wide"],cost:"Included with Tenable.io license",hrs:12}
};

D2["3.4.2e"] = {
aws:{svc:["AWS Config","AWS Systems Manager","AWS Security Hub","AWS Lambda","AWS Firewall Manager"],st:["Deploy Config rules with auto-remediation for unauthorized or misconfigured components","Configure Systems Manager Inventory for automated component discovery across instances","Implement Security Hub automated response actions for non-compliant resources","Deploy Lambda functions quarantining unauthorized resources to isolated VPCs","Create Config conformance packs defining authorized component baselines"],cost:"$100-500/month",hrs:28},
azure:{svc:["Azure Policy","Microsoft Defender for Cloud","Azure Automation","Azure Monitor","Microsoft Intune"],st:["Deploy Azure Policy with DeployIfNotExists for automated component remediation","Configure Defender for Cloud for automated discovery and posture management","Implement Azure Automation runbooks quarantining unauthorized resources","Set up Azure Monitor alerts for unauthorized component detection","Deploy Intune compliance policies auto-remediating non-compliant devices"],cost:"$100-400/month",hrs:24},
gcp:{svc:["Organization Policy","Security Command Center","Cloud Functions","OS Config","Cloud Asset Inventory"],st:["Deploy Cloud Asset Inventory for automated discovery of all system components","Configure SCC Premium for automated finding detection and remediation","Implement Cloud Functions for custom quarantine workflows for unauthorized components","Deploy OS Config for VM configuration management and drift remediation","Create Organization Policy constraints blocking unauthorized component types"],cost:"$100-400/month",hrs:24},
s1:{svc:["Singularity XDR","Ranger","Firewall Control","Device Control","Remote Shell"],st:["Deploy Ranger for automated network device discovery and classification","Configure automated network isolation for unauthorized/unmanaged devices","Implement Firewall Control quarantining endpoints with unauthorized software","Create STAR rules detecting unauthorized component installations","Use Remote Shell for automated remediation of non-compliant endpoints"],cost:"Included with Singularity Complete + Ranger",hrs:14},
ninja:{svc:["NinjaOne RMM","Device Discovery","Scripting","Monitoring","Patch Management"],st:["Deploy NinjaOne device discovery identifying all managed and unmanaged components","Configure monitoring conditions detecting unauthorized software installations","Implement automated remediation scripts removing unauthorized components","Set up patch management auto-remediating missing security updates","Create alerting for new unmanaged devices appearing on the network"],cost:"Included with NinjaOne license",hrs:12},
ten:{svc:["Tenable.io","Nessus Network Monitor","CIS Benchmarks","Compliance Scanning"],st:["Deploy Nessus Network Monitor for passive discovery of all network components","Configure continuous compliance scanning against CIS/STIG baselines","Implement automated alerts for configuration drift and unauthorized changes","Create remediation tracking workflows for detected non-compliant components","Set up dashboards tracking component compliance and remediation status"],cost:"Included with Tenable.io license",hrs:14}
};

D2["3.4.3e"] = {
aws:{svc:["AWS Systems Manager","AWS AppStream","AWS Config","AWS Lambda","AWS Signer"],st:["Implement application allowlisting via Systems Manager Application Manager","Deploy Config rules detecting execution of non-approved applications","Configure AppStream 2.0 with curated approved application catalog only","Create Lambda functions auto-remediating unauthorized application installations","Implement AWS Signer code signing requirements for all deployed applications"],cost:"$100-500/month",hrs:24},
azure:{svc:["Windows Defender Application Control","Microsoft Intune","Entra ID App Registration","Defender for Endpoint"],st:["Deploy WDAC policies enforcing application allowlisting on all CUI endpoints","Configure Intune application deployment restricted to approved apps only","Implement Entra ID App Registration vetting with security review gates","Deploy Defender for Endpoint application control for runtime enforcement","Create code signing requirements for all internally developed applications"],cost:"Included with M365 E5/Intune",hrs:20},
gcp:{svc:["Binary Authorization","GKE Admission Controllers","Cloud Build","Artifact Registry"],st:["Deploy Binary Authorization for container workload allowlisting","Configure GKE admission controllers rejecting non-approved container images","Implement Cloud Build attestation pipeline for application vetting","Restrict Artifact Registry to vetted and approved packages only","Create application vetting pipeline with automated security scanning gates"],cost:"$50-200/month",hrs:20},
s1:{svc:["Singularity XDR","Application Control","Deep Visibility","STAR Rules"],st:["Deploy SentinelOne Application Control enforcing endpoint allowlisting","Configure STAR rules detecting and blocking unauthorized application execution","Implement Deep Visibility monitoring for application inventory changes","Set up automated quarantine for unauthorized executable launches","Create application vetting workflows integrated with change management"],cost:"Included with Singularity Complete",hrs:16},
ninja:{svc:["NinjaOne RMM","Software Management","Scripting","Monitoring"],st:["Configure NinjaOne software management with organization-approved application list","Deploy scripts enforcing application allowlisting policies on endpoints","Implement monitoring detecting unauthorized software installations","Set up automated removal scripts for non-approved applications","Document application vetting process and approved list in knowledge base"],cost:"Included with NinjaOne license",hrs:12}
};

D2["3.5.1e"] = {
aws:{svc:["AWS IAM Identity Center","AWS Private CA","AWS Client VPN","FIDO2 Security Keys"],st:["Configure IAM Identity Center with FIDO2 hardware security keys for all users","Deploy certificate-based mutual TLS using AWS Private CA for service-to-service auth","Implement Client VPN with certificate-based plus FIDO2 authentication","Enable replay-resistant protocols (FIDO2/WebAuthn) for all console and API access","Phase out password-based and SMS-based authentication methods entirely"],cost:"$100-500/month + FIDO2 keys",hrs:32},
azure:{svc:["Entra ID","FIDO2 Security Keys","Windows Hello for Business","Conditional Access","Certificate-Based Auth"],st:["Deploy FIDO2 security key registration for all users (privileged and non-privileged)","Configure Conditional Access requiring phishing-resistant MFA for all access","Implement certificate-based authentication in Entra ID for service accounts","Deploy Windows Hello for Business with TPM attestation for domain-joined devices","Enable mutual TLS for Azure App Service and API Management endpoints"],cost:"$50-200/month + FIDO2 keys ($25-60 each)",hrs:28},
gcp:{svc:["Cloud Identity","Titan Security Keys","BeyondCorp Enterprise","Certificate Authority Service"],st:["Deploy Titan Security Keys for FIDO2 authentication for all users","Configure BeyondCorp Enterprise requiring phishing-resistant MFA","Implement Certificate Authority Service for mutual TLS certificates","Enable context-aware access with device certificate requirements","Deploy Identity-Aware Proxy with certificate-based authentication"],cost:"$50-200/month + Titan keys",hrs:26},
pa:{svc:["GlobalProtect","Certificate Authentication","SAML/MFA Integration","User-ID"],st:["Configure GlobalProtect with certificate-based mutual authentication","Implement SAML integration with phishing-resistant MFA provider (FIDO2)","Deploy User-ID with multi-factor verification requirements for all users","Set up certificate-based authentication for all management plane access","Enable comprehensive audit logging for all authentication events"],cost:"Included with GlobalProtect license",hrs:14},
s1:{svc:["Singularity ITDR","Singularity XDR","Deep Visibility"],st:["Deploy ITDR to monitor authentication patterns and detect non-MFA access","Configure alerts for authentication attempts not using replay-resistant methods","Monitor for credential replay attack indicators via Deep Visibility","Implement STAR rules detecting credential theft, pass-the-hash, and token replay","Correlate authentication anomalies with endpoint behavior for threat detection"],cost:"Included with Singularity + ITDR",hrs:14},
ninja:{svc:["NinjaOne RMM","MFA Integration","Device Management","Monitoring"],st:["Configure NinjaOne with MFA (FIDO2 preferred) for all administrative access","Implement device compliance checks verifying MFA enrollment before RMM access","Deploy monitoring for authentication anomalies on managed endpoints","Set up alerts for failed or non-MFA authentication attempts","Document MFA requirements and enrollment procedures in knowledge base"],cost:"Included with NinjaOne license",hrs:10},
ten:{svc:["Tenable.io","Tenable.ad","Compliance Auditing"],st:["Deploy Tenable.ad to monitor authentication infrastructure for weaknesses","Configure compliance audits verifying MFA enforcement across all systems","Scan for weak authentication configurations (password-only, SMS MFA)","Monitor for credential-related vulnerabilities and misconfigurations","Create dashboards tracking MFA and replay-resistant auth compliance"],cost:"Included with Tenable.io license",hrs:12}
};

D2["3.5.2e"] = {
aws:{svc:["AWS Verified Access","AWS Systems Manager","AWS Config","AWS IoT Device Defender"],st:["Deploy Verified Access requiring device identity verification before application access","Configure Systems Manager requiring managed instance identity for all connections","Implement Config rules detecting non-compliant or unidentified resources","Deploy IoT Device Defender for IoT device identity authentication","Create automated Lambda quarantine for devices failing identity verification"],cost:"$100-500/month",hrs:28},
azure:{svc:["Entra Global Secure Access","Conditional Access","Microsoft Intune","Defender for Endpoint"],st:["Deploy Entra Global Secure Access requiring device identity for network access","Configure Conditional Access with device compliance and identity requirements","Implement Intune device health attestation blocking non-compliant devices","Deploy Defender for Endpoint device risk-based access controls","Create automated remediation workflows for non-compliant devices"],cost:"$100-400/month",hrs:24},
gcp:{svc:["BeyondCorp Enterprise","Access Context Manager","Endpoint Verification","Cloud IAM"],st:["Deploy BeyondCorp Enterprise requiring device identity for all access","Configure Access Context Manager with device identity policy requirements","Implement Endpoint Verification for device compliance and identity checking","Create access levels requiring device encryption, OS updates, and identity","Deploy automated access revocation for devices failing identity verification"],cost:"$100-400/month",hrs:22},
pa:{svc:["GlobalProtect","HIP Checks","IoT Security","Device-ID"],st:["Configure GlobalProtect with Host Information Profile (HIP) compliance checks","Deploy IoT Security for automated device profiling and policy enforcement","Implement Device-ID for network-connected device classification","Create security policies based on device compliance status","Set up automated quarantine VLAN for non-compliant devices"],cost:"$500-2000/month (IoT Security)",hrs:20},
s1:{svc:["Singularity Ranger","Singularity XDR","Firewall Control"],st:["Deploy Ranger for network device discovery and compliance monitoring","Configure Firewall Control blocking connections from unknown devices","Implement automated isolation for non-compliant endpoints","Create STAR rules detecting unauthorized device connections","Set up XDR correlation for device compliance monitoring"],cost:"Included with Singularity + Ranger",hrs:14},
ninja:{svc:["NinjaOne RMM","Device Management","Monitoring","Scripting"],st:["Deploy NinjaOne agent as device compliance verification mechanism","Configure monitoring to detect unmanaged devices on network","Implement compliance policies blocking non-NinjaOne-managed devices","Deploy scripts verifying device configuration before network access","Set up alerts for new unmanaged device connections"],cost:"Included with NinjaOne license",hrs:12}
};

D2["3.5.3e"] = {
aws:{svc:["AWS IAM Identity Center","FIDO2","AWS Private CA","AWS SSO"],st:["Configure IAM Identity Center with FIDO2 security key support as primary auth","Deploy certificate-based authentication using AWS Private CA for services","Implement passkey support for AWS console access","Phase out password-based authentication for all user accounts","Create passwordless authentication adoption tracking metrics"],cost:"$50-200/month + FIDO2 keys",hrs:20},
azure:{svc:["Microsoft Authenticator","FIDO2 Security Keys","Windows Hello for Business","Entra ID"],st:["Deploy Microsoft Authenticator passwordless phone sign-in for all users","Configure FIDO2 security key registration as primary authentication method","Implement Windows Hello for Business with TPM attestation","Create Conditional Access policies requiring passwordless methods only","Phase out password authentication using temporary access passes for onboarding"],cost:"Included with Entra ID P1/P2 + FIDO2 keys",hrs:18},
gcp:{svc:["Titan Security Keys","Cloud Identity","BeyondCorp","Passkeys"],st:["Deploy Titan Security Keys for FIDO2 passwordless authentication","Configure Cloud Identity to support passkey enrollment for all users","Implement BeyondCorp with passwordless access requirements","Create policies requiring phishing-resistant passwordless methods","Phase out password-based authentication across all services"],cost:"$50-150/month + Titan keys",hrs:16},
s1:{svc:["Singularity ITDR","Deep Visibility"],st:["Deploy ITDR to monitor for password-based authentication attempts","Configure alerts for password usage where passwordless is required","Monitor for credential theft indicators via Deep Visibility","Create detection rules for password spray and brute force attacks","Track passwordless adoption through authentication telemetry"],cost:"Included with Singularity + ITDR",hrs:10}
};

D2["3.6.1e"] = {
aws:{svc:["AWS Security Hub","Amazon GuardDuty","AWS Step Functions","Amazon Detective","CloudTrail"],st:["Deploy Security Hub as centralized SOC dashboard for all AWS accounts","Configure GuardDuty for continuous 24/7 threat detection across all regions","Implement Step Functions for automated incident response (SOAR) workflows","Deploy Detective for automated investigation and root cause analysis","Create SOC runbooks for AWS-specific incident scenarios and escalation paths"],cost:"$500-5000/month (or MSSP)",hrs:80},
azure:{svc:["Microsoft Sentinel","Defender XDR","Logic Apps","Azure Monitor"],st:["Deploy Sentinel as primary SOC SIEM platform with all data connectors","Configure Defender XDR for unified detection and response across M365/Azure","Implement Logic Apps SOAR playbooks for automated incident response","Set up Azure Monitor for infrastructure health and availability monitoring","Create SOC operational procedures, escalation paths, and shift schedules"],cost:"$1000-5000/month (or MSSP)",hrs:80},
gcp:{svc:["Chronicle SIEM","Chronicle SOAR","Security Command Center"],st:["Deploy Chronicle SIEM as SOC detection and investigation platform","Configure Chronicle SOAR for automated incident response playbooks","Integrate SCC Premium findings into SOC monitoring workflows","Create GCP-specific incident response playbooks and runbooks","Establish SOC operational procedures, metrics, and SLA targets"],cost:"$1000-5000/month (or MSSP)",hrs:80},
pa:{svc:["Cortex XSOAR","Panorama","Cortex XDR","WildFire"],st:["Deploy Cortex XSOAR for security orchestration and automated response","Configure Panorama for centralized network incident visibility","Implement Cortex XDR for endpoint detection and response integration","Use WildFire for automated malware analysis during incidents","Create incident response playbooks for network-based threats"],cost:"$500-3000/month (Cortex)",hrs:30},
s1:{svc:["Singularity XDR","Vigilance MDR","Storyline","STAR Rules","Forensics"],st:["Deploy Singularity XDR as core SOC endpoint detection platform","Consider Vigilance MDR for 24/7 SOC coverage if internal SOC not feasible","Configure STAR rules for APT-specific detection aligned with threat model","Implement Storyline for automated investigation and attack visualization","Use forensic capabilities for incident evidence collection and preservation"],cost:"$5-15/endpoint/month (Vigilance MDR)",hrs:40},
ninja:{svc:["NinjaOne RMM","Remote Access","Scripting","Monitoring","Ticketing"],st:["Integrate NinjaOne into SOC operational workflows for endpoint response","Configure monitoring alerts feeding into SOC ticketing system","Deploy remote access capabilities for SOC-directed incident response","Create automated remediation scripts triggered by SOC workflows","Set up NinjaOne dashboards for SOC endpoint operational visibility"],cost:"Included with NinjaOne license",hrs:16},
ten:{svc:["Tenable.io","Vulnerability Intelligence","Asset Criticality"],st:["Integrate vulnerability data into SOC incident response workflows","Use VPR to prioritize incident-related vulnerability remediation","Deploy asset criticality to focus IR efforts on critical CUI systems","Create incident-triggered vulnerability scan workflows","Generate post-incident vulnerability assessment reports"],cost:"Included with Tenable.io license",hrs:12}
};

D2["3.6.2e"] = {
aws:{svc:["AWS CloudTrail","Amazon GuardDuty","AWS Security Hub","Amazon S3 Glacier"],st:["Configure CloudTrail for comprehensive incident evidence collection and preservation","Set up GuardDuty findings export for incident reporting to DIBNet","Create Security Hub custom actions for automated incident report generation","Implement S3 Glacier with Object Lock for tamper-proof evidence preservation","Establish 72-hour reporting procedures with DIBNet integration and templates"],cost:"$50-200/month",hrs:24},
azure:{svc:["Microsoft Sentinel","Defender XDR","Microsoft Purview eDiscovery","Azure Blob Immutable Storage"],st:["Configure Sentinel incident export for DoD reporting format compliance","Implement Purview eDiscovery for legal-hold evidence preservation","Create automated incident report templates in Sentinel workbooks","Set up Defender XDR incident timeline for comprehensive reporting","Establish 72-hour reporting procedures with DIBNet and DCISE"],cost:"$100-400/month",hrs:24},
gcp:{svc:["Chronicle","Security Command Center","Cloud Logging","Cloud Storage"],st:["Configure Chronicle for incident evidence collection and export","Set up SCC finding export for incident reporting format compliance","Create automated incident report generation workflows","Implement Cloud Storage with retention policies for evidence preservation","Establish 72-hour reporting procedures with DIBNet integration"],cost:"$100-300/month",hrs:24},
s1:{svc:["Singularity XDR","Storyline","Deep Visibility","Forensics"],st:["Configure SentinelOne for incident evidence collection and export","Use Storyline for incident timeline reconstruction for DoD reports","Implement Deep Visibility queries for forensic evidence gathering","Create incident report templates using SentinelOne data exports","Integrate incident data export with DIBNet reporting workflow"],cost:"Included with Singularity license",hrs:16}
};

D2["3.11.1e"] = {
aws:{svc:["Amazon Detective","Amazon GuardDuty","CloudTrail Lake","Amazon OpenSearch","AWS Lambda"],st:["Deploy Detective for automated investigation and threat hunting capabilities","Use GuardDuty findings as threat hunting starting points and IOC sources","Implement CloudTrail Lake for SQL-based threat hunting queries across accounts","Deploy OpenSearch for advanced log analysis and hypothesis-driven hunting","Create threat hunting playbooks based on MITRE ATT&CK for Cloud matrix"],cost:"$200-1000/month",hrs:40},
azure:{svc:["Microsoft Sentinel Hunting","Defender Advanced Hunting","Microsoft Threat Intelligence","Defender for Cloud"],st:["Deploy Sentinel hunting queries aligned with MITRE ATT&CK cloud techniques","Configure Defender Advanced Hunting for endpoint-based threat hunting","Integrate Microsoft Threat Intelligence for IOC-based hunting campaigns","Enable Defender for Cloud for proactive security posture hunting","Create hunting playbooks for APT-specific TTPs targeting CUI environments"],cost:"$300-1500/month",hrs:36},
gcp:{svc:["Chronicle SIEM","Security Command Center Premium","BigQuery","VirusTotal"],st:["Deploy Chronicle with YARA-L rules for proactive threat hunting","Configure SCC Premium for advanced vulnerability and threat analysis","Use BigQuery for large-scale log analysis and hypothesis-driven hunting","Integrate VirusTotal for IOC enrichment during hunting campaigns","Create threat hunting playbooks for GCP-specific APT techniques"],cost:"$500-2000/month",hrs:36},
pa:{svc:["Cortex XDR","AutoFocus","WildFire","Panorama"],st:["Deploy Cortex XDR for endpoint and network threat hunting capabilities","Use AutoFocus threat intelligence for IOC-based hunting campaigns","Leverage WildFire analysis for malware hunting and sample analysis","Configure Panorama for network-based threat hunting queries","Create hunting playbooks for network-specific APT TTPs"],cost:"$500-3000/month (Cortex)",hrs:24},
s1:{svc:["Singularity XDR","Deep Visibility","STAR Rules","Threat Intelligence"],st:["Deploy Deep Visibility for endpoint-based proactive threat hunting","Create STAR rules for proactive APT indicator detection and alerting","Use threat intelligence integration for IOC-based hunting campaigns","Implement Storyline analysis for attack chain investigation during hunts","Conduct regular hunting missions based on current APT TTPs and intelligence"],cost:"Included with Singularity Complete",hrs:20},
ninja:{svc:["NinjaOne RMM","Scripting","Monitoring","Activity Log"],st:["Deploy hunting scripts via NinjaOne to collect IOC data from endpoints","Configure monitoring conditions to detect threat hunting indicators","Use activity logs to identify anomalous administrative actions","Create automated IOC sweep scripts for rapid threat hunting across fleet","Set up scheduled hunting data collection across all managed devices"],cost:"Included with NinjaOne license",hrs:14},
ten:{svc:["Tenable.io","Tenable.ad","VPR","Vulnerability Intelligence"],st:["Use VPR to identify actively exploited vulnerabilities for threat hunting","Deploy Tenable.ad to hunt for AD-based attack indicators and persistence","Configure vulnerability intelligence feeds for threat-informed hunting","Create vulnerability-based hunting queries for APT exploitation patterns","Integrate Tenable findings with threat hunting workflows and reports"],cost:"Included with Tenable.io license",hrs:14}
};

D2["3.11.2e"] = {
aws:{svc:["AWS Security Hub","Amazon GuardDuty","AWS Config","AWS Inspector","AWS Trusted Advisor"],st:["Deploy Security Hub with automated security best practice checks","Configure GuardDuty for continuous threat and anomaly detection","Implement Config rules for continuous compliance monitoring","Deploy Inspector for automated vulnerability assessment","Use Trusted Advisor for security and cost optimization checks"],cost:"$100-500/month",hrs:24},
azure:{svc:["Microsoft Defender for Cloud","Azure Policy","Defender CSPM","Azure Advisor"],st:["Deploy Defender for Cloud with enhanced security posture management","Configure Azure Policy for continuous compliance assessment","Implement Defender CSPM for advanced posture analysis and attack paths","Use Azure Advisor for security and operational recommendations","Create security posture dashboards and improvement tracking"],cost:"$200-800/month",hrs:22},
gcp:{svc:["Security Command Center Premium","Security Health Analytics","Web Security Scanner","Cloud Asset Inventory"],st:["Enable SCC Premium for comprehensive security posture assessment","Configure Security Health Analytics for continuous vulnerability detection","Deploy Web Security Scanner for application security assessment","Use Cloud Asset Inventory for complete resource visibility","Create security posture improvement plans and tracking dashboards"],cost:"$200-800/month",hrs:22},
s1:{svc:["Singularity XDR","Ranger","Application Inventory","Deep Visibility"],st:["Deploy Ranger for continuous network security posture assessment","Use Application Inventory for software vulnerability posture tracking","Configure Deep Visibility for security posture monitoring","Create STAR rules for detecting security posture degradation","Implement automated reporting on endpoint security posture trends"],cost:"Included with Singularity Complete",hrs:14},
ten:{svc:["Tenable.io","Tenable.cs","CIS Benchmarks","STIG Audits","Lumin"],st:["Deploy Tenable.io for continuous vulnerability posture assessment","Configure CIS Benchmark and STIG compliance scanning","Implement Tenable Lumin for cyber exposure scoring and trending","Create risk-based vulnerability prioritization using VPR","Set up executive dashboards tracking security posture over time"],cost:"Included with Tenable.io license",hrs:16}
};

D2["3.11.3e"] = {
aws:{svc:["Amazon GuardDuty","AWS Security Hub","CloudTrail","AWS Config","Amazon Detective"],st:["Deploy GuardDuty for continuous monitoring of threats to CUI systems","Configure Security Hub for centralized threat and vulnerability visibility","Implement CloudTrail for comprehensive audit trail of all API activity","Deploy Config rules monitoring for security-relevant configuration changes","Use Detective for automated investigation of identified threats"],cost:"$100-500/month",hrs:24},
azure:{svc:["Microsoft Defender for Cloud","Microsoft Sentinel","Defender XDR","Azure Monitor"],st:["Deploy Defender for Cloud for continuous threat monitoring of CUI resources","Configure Sentinel for real-time threat detection and alerting","Implement Defender XDR for unified threat visibility across all services","Set up Azure Monitor for infrastructure health and threat monitoring","Create automated response playbooks for detected threats"],cost:"$200-1000/month",hrs:24},
gcp:{svc:["Security Command Center","Chronicle","Cloud Monitoring","Event Threat Detection"],st:["Enable SCC Premium for continuous threat monitoring across all projects","Deploy Chronicle for real-time threat detection and investigation","Configure Cloud Monitoring for infrastructure threat indicators","Implement Event Threat Detection for automated threat identification","Create threat monitoring dashboards and automated alerting"],cost:"$200-1000/month",hrs:24},
pa:{svc:["Cortex XDR","Threat Prevention","WildFire","DNS Security","Panorama"],st:["Deploy Cortex XDR for continuous endpoint and network threat monitoring","Configure Threat Prevention with up-to-date IPS/IDS signatures","Enable WildFire for real-time malware analysis and detection","Implement DNS Security blocking C2 and malicious domain communications","Use Panorama for centralized threat monitoring across all firewalls"],cost:"$500-2000/month",hrs:18},
s1:{svc:["Singularity XDR","Storyline","STAR Rules","Deep Visibility","Vigilance MDR"],st:["Deploy Singularity XDR for continuous endpoint threat monitoring","Configure STAR rules for APT-specific threat detection","Implement Storyline for automated threat investigation","Enable Deep Visibility for proactive threat monitoring queries","Consider Vigilance MDR for 24/7 continuous threat monitoring"],cost:"Included with Singularity Complete",hrs:16},
ten:{svc:["Tenable.io","Continuous Scanning","VPR","Asset Criticality"],st:["Deploy continuous vulnerability scanning for all CUI systems","Configure VPR-based prioritization for actively exploited threats","Implement asset criticality to focus monitoring on critical CUI assets","Create continuous monitoring dashboards for vulnerability trends","Set up automated alerts for new critical vulnerabilities on CUI systems"],cost:"Included with Tenable.io license",hrs:12}
};

D2["3.13.1e"] = {
aws:{svc:["AWS VPC","AWS Network Firewall","AWS Transit Gateway","AWS PrivateLink","AWS WAF"],st:["Implement VPC isolation with dedicated CUI VPCs and strict security groups","Deploy Network Firewall with stateful inspection between network segments","Configure Transit Gateway with route table isolation for CUI traffic","Use PrivateLink for all cross-VPC service access eliminating internet exposure","Deploy WAF with managed rule groups for application-layer protection"],cost:"$200-1000/month",hrs:32},
azure:{svc:["Azure Virtual Network","Azure Firewall Premium","Private Link","Azure DDoS Protection","Azure Front Door"],st:["Implement VNet isolation with dedicated CUI subscriptions and NSGs","Deploy Azure Firewall Premium with IDPS and TLS inspection between segments","Use Private Link for all PaaS service access eliminating public endpoints","Configure DDoS Protection Standard for all CUI-facing resources","Deploy Azure Front Door with WAF for application-layer protection"],cost:"$300-1500/month",hrs:28},
gcp:{svc:["VPC Networks","Cloud Armor","VPC Service Controls","Cloud NAT","Cloud Interconnect"],st:["Implement VPC network isolation with dedicated projects for CUI workloads","Deploy Cloud Armor for application-layer protection and DDoS mitigation","Configure VPC Service Controls for data exfiltration prevention","Use Cloud NAT for controlled and monitored egress traffic","Implement Private Google Access for service isolation from internet"],cost:"$200-1000/month",hrs:26},
pa:{svc:["PAN-OS Zones","Threat Prevention","WildFire","DNS Security","URL Filtering"],st:["Implement zone-based segmentation isolating CUI from non-CUI networks","Deploy Threat Prevention profiles on all inter-zone security policies","Configure WildFire for advanced malware analysis at network boundary","Enable DNS Security blocking C2 and malicious domain communications","Set up URL Filtering restricting web access from CUI segments"],cost:"$500-3000/month",hrs:20},
s1:{svc:["Singularity XDR","Firewall Control","Ranger","Network Control"],st:["Deploy Firewall Control for endpoint-level network segmentation enforcement","Configure Ranger for network device discovery and segment monitoring","Implement Network Control restricting endpoint communications to authorized paths","Create STAR rules detecting lateral movement and segment boundary violations","Enable Deep Visibility for network traffic analysis across segments"],cost:"Included with Singularity Complete + Ranger",hrs:16},
ninja:{svc:["NinjaOne RMM","Firewall Management","Monitoring","Scripting"],st:["Deploy endpoint firewall rules via NinjaOne policies for micro-segmentation","Configure monitoring for unauthorized cross-segment communications","Implement scripts verifying network isolation configurations","Set up alerts for network configuration changes on CUI systems","Create documentation of network segmentation architecture"],cost:"Included with NinjaOne license",hrs:12},
ten:{svc:["Tenable.io","Network Scanning","Compliance Auditing","Asset Discovery"],st:["Deploy network scans verifying segmentation effectiveness","Configure compliance audits for firewall rule validation","Use asset discovery to map all network connections and paths","Implement continuous monitoring for segmentation drift","Create dashboards tracking network isolation compliance"],cost:"Included with Tenable.io license",hrs:14}
};

D2["3.13.2e"] = {
aws:{svc:["AWS KMS","AWS CloudHSM","AWS Certificate Manager","AWS Nitro Enclaves","S3 Encryption"],st:["Deploy KMS with customer-managed keys for all CUI data encryption at rest","Configure CloudHSM for FIPS 140-2 Level 3 validated key management","Implement Certificate Manager for TLS certificate lifecycle management","Deploy Nitro Enclaves for processing CUI in isolated compute environments","Enforce S3 server-side encryption with KMS keys for all CUI buckets"],cost:"$100-1000/month (CloudHSM ~$1.20/hr)",hrs:28},
azure:{svc:["Azure Key Vault","Managed HSM","Azure Disk Encryption","Azure Storage Encryption","TLS 1.3"],st:["Deploy Key Vault with Managed HSM for FIPS 140-2 Level 3 key management","Configure Azure Disk Encryption with customer-managed keys for all CUI VMs","Implement Storage Service Encryption with customer-managed keys","Enforce TLS 1.3 for all data in transit across Azure services","Deploy Azure Confidential Computing for sensitive CUI processing"],cost:"$200-1500/month (Managed HSM ~$3/hr)",hrs:26},
gcp:{svc:["Cloud KMS","Cloud HSM","Cloud External Key Manager","Confidential Computing","Certificate Authority Service"],st:["Deploy Cloud KMS with customer-managed encryption keys for all CUI data","Configure Cloud HSM for FIPS 140-2 Level 3 validated key management","Implement External Key Manager for keys stored outside Google infrastructure","Deploy Confidential Computing VMs for CUI processing with memory encryption","Enforce TLS 1.3 for all data in transit using Certificate Authority Service"],cost:"$100-800/month (Cloud HSM additional)",hrs:24},
pa:{svc:["PAN-OS SSL/TLS","IPSec VPN","MACsec","Certificate Management"],st:["Configure SSL/TLS decryption with FIPS-validated cipher suites","Deploy IPSec VPN tunnels with strong encryption for site-to-site CUI traffic","Implement MACsec for link-layer encryption on CUI network segments","Manage certificates using integrated certificate management","Enable FIPS-CC mode on all firewalls processing CUI traffic"],cost:"Included with NGFW license",hrs:16},
s1:{svc:["Singularity XDR","Full Disk Encryption Monitoring","Deep Visibility"],st:["Monitor endpoint encryption status via Singularity console","Configure alerts for endpoints with disabled or degraded encryption","Deploy Deep Visibility to detect unencrypted data transfers","Create STAR rules detecting CUI data transmitted without encryption","Verify TLS enforcement on all endpoint communications"],cost:"Included with Singularity Complete",hrs:10},
ninja:{svc:["NinjaOne RMM","BitLocker Management","Monitoring","Scripting"],st:["Deploy BitLocker/FileVault management via NinjaOne for full disk encryption","Configure monitoring for encryption status on all CUI endpoints","Implement scripts verifying TLS configuration on managed systems","Set up alerts for endpoints with disabled or non-compliant encryption","Create encryption compliance dashboards and reporting"],cost:"Included with NinjaOne license",hrs:10},
ten:{svc:["Tenable.io","Compliance Auditing","CIS Benchmarks"],st:["Deploy compliance audits verifying encryption at rest and in transit","Configure CIS Benchmark scans for cryptographic configuration compliance","Scan for weak cipher suites and deprecated TLS versions","Monitor for certificate expiration and misconfiguration","Create dashboards tracking encryption compliance across all systems"],cost:"Included with Tenable.io license",hrs:10}
};

D2["3.14.1e"] = {
aws:{svc:["Amazon GuardDuty","AWS Lambda","AWS Nitro Enclaves","AWS Signer","Amazon Inspector"],st:["Deploy GuardDuty with automated Lambda response for malicious code detection","Implement Nitro Enclaves for integrity verification of critical software","Use AWS Signer for code signing of all deployed artifacts","Deploy Inspector for continuous vulnerability and integrity scanning","Configure automated containment for detected malicious activity"],cost:"$100-500/month",hrs:28},
azure:{svc:["Defender for Endpoint","Defender for Cloud","Microsoft Sentinel","Azure Trusted Launch","Safe Attachments"],st:["Deploy Defender for Endpoint with automated investigation and response","Enable Azure Trusted Launch VMs with Secure Boot and vTPM","Configure Safe Attachments for email sandboxing and malicious content detection","Implement Sentinel SOAR playbooks for automated malicious code response","Enable attack disruption for automated containment of active threats"],cost:"$100-500/month",hrs:24},
gcp:{svc:["Security Command Center","Shielded VMs","Binary Authorization","Cloud Functions","Web Security Scanner"],st:["Enable Shielded VMs with Secure Boot and vTPM for boot integrity","Deploy Binary Authorization for container integrity verification","Configure Cloud Functions for automated threat response workflows","Implement Web Security Scanner for application integrity testing","Use SCC Premium for automated finding remediation"],cost:"$100-400/month",hrs:22},
pa:{svc:["WildFire","Threat Prevention","DNS Security","Cortex XDR"],st:["Deploy WildFire for advanced sandboxing of suspicious files at network boundary","Configure Threat Prevention with anti-malware and IPS signatures","Enable DNS Security to block malicious domain and C2 communications","Implement Cortex XDR for endpoint integrity monitoring","Set up automated quarantine for detected malicious content"],cost:"$500-2000/month",hrs:18},
s1:{svc:["Singularity XDR","Static AI","Behavioral AI","STAR Rules","Storyline"],st:["Deploy Static AI and Behavioral AI for real-time malicious code detection","Configure automated response (quarantine, remediate, rollback)","Implement STAR rules for custom malicious code detection patterns","Use Storyline for automated attack chain analysis and visualization","Enable automated containment and network isolation for threats"],cost:"Included with Singularity Complete",hrs:14},
ninja:{svc:["NinjaOne RMM","Patch Management","Monitoring","Scripting","Backup"],st:["Deploy automated patch management to remediate known vulnerabilities","Configure monitoring for integrity verification failures on endpoints","Implement scripts for automated malware scanning and response","Set up backup policies for rapid recovery from integrity violations","Create automated remediation workflows for detected threats"],cost:"Included with NinjaOne license",hrs:12},
ten:{svc:["Tenable.io","Nessus","Vulnerability Scanning","Compliance Auditing"],st:["Deploy continuous vulnerability scanning for integrity assessment","Configure compliance audits for secure boot and code signing verification","Implement vulnerability prioritization using VPR for active threats","Create dashboards tracking system integrity compliance","Set up automated alerts for critical integrity-related vulnerabilities"],cost:"Included with Tenable.io license",hrs:12}
};

D2["3.14.2e"] = {
aws:{svc:["Amazon GuardDuty","AWS Security Hub","CloudTrail","AWS Config","Amazon Macie"],st:["Deploy GuardDuty for automated detection of anomalous behavior and indicators","Configure Security Hub for centralized indicator monitoring and alerting","Implement CloudTrail for comprehensive API activity monitoring","Use Config rules to detect configuration-based indicators of compromise","Deploy Macie for detecting unauthorized CUI data access patterns"],cost:"$100-500/month",hrs:24},
azure:{svc:["Microsoft Sentinel","Defender XDR","Microsoft Threat Intelligence","UEBA"],st:["Deploy Sentinel with threat intelligence data connectors for IOC monitoring","Configure Defender XDR for automated indicator detection across all services","Integrate Microsoft Threat Intelligence for real-time IOC feeds","Enable UEBA for behavioral anomaly detection and insider threat indicators","Create custom analytics rules for organization-specific threat indicators"],cost:"$200-1000/month",hrs:24},
gcp:{svc:["Chronicle","Security Command Center","Event Threat Detection","VirusTotal"],st:["Deploy Chronicle with threat intelligence feeds for IOC detection","Configure SCC for automated security finding detection","Implement Event Threat Detection for real-time indicator monitoring","Integrate VirusTotal for file and URL reputation checking","Create YARA-L rules for organization-specific threat indicators"],cost:"$200-1000/month",hrs:24},
s1:{svc:["Singularity XDR","Threat Intelligence","STAR Rules","Deep Visibility"],st:["Configure threat intelligence integration for automated IOC detection","Deploy STAR rules for custom indicator detection patterns","Implement Deep Visibility queries for proactive indicator hunting","Enable automated response for confirmed indicators of compromise","Correlate indicators across endpoint, network, and identity sources"],cost:"Included with Singularity Complete",hrs:14},
ten:{svc:["Tenable.io","VPR","Vulnerability Intelligence","Tenable.ad"],st:["Use VPR to identify vulnerabilities associated with active threat indicators","Deploy Tenable.ad to detect AD-based indicators of compromise","Configure vulnerability intelligence for threat-informed scanning","Create dashboards correlating vulnerabilities with active threat indicators","Integrate Tenable findings with SOC indicator monitoring workflows"],cost:"Included with Tenable.io license",hrs:12}
};

D2["3.14.3e"] = {
aws:{svc:["AWS Security Hub","Amazon GuardDuty","AWS Config","AWS Systems Manager","AWS Organizations"],st:["Deploy Security Hub with automated security checks across all accounts","Configure GuardDuty for continuous threat detection with automated response","Implement Config rules with auto-remediation for security violations","Use Systems Manager for automated patching and configuration management","Create Organizations-wide security policies and guardrails"],cost:"$100-500/month",hrs:24},
azure:{svc:["Microsoft Defender for Cloud","Azure Policy","Microsoft Sentinel","Azure Automation"],st:["Deploy Defender for Cloud with automated security recommendations","Configure Azure Policy with auto-remediation for security violations","Implement Sentinel with automated response playbooks","Use Azure Automation for security task automation","Create security automation workflows for common security operations"],cost:"$200-800/month",hrs:22},
gcp:{svc:["Security Command Center","Organization Policy","Cloud Functions","OS Config"],st:["Enable SCC Premium with automated remediation capabilities","Configure Organization Policy for security constraint enforcement","Implement Cloud Functions for custom security automation","Deploy OS Config for automated configuration management","Create security automation pipelines for common operations"],cost:"$200-800/month",hrs:22},
s1:{svc:["Singularity XDR","Automated Response","STAR Rules","Remote Shell"],st:["Configure automated threat response policies (detect, protect, respond)","Deploy STAR rules with automated response actions","Implement Remote Shell for automated remediation scripts","Enable automated network isolation for confirmed threats","Create automated security operations workflows"],cost:"Included with Singularity Complete",hrs:14},
ninja:{svc:["NinjaOne RMM","Scripting","Patch Management","Monitoring"],st:["Deploy automated security scripts for common security operations","Configure automated patch management for security updates","Implement monitoring with automated remediation actions","Set up automated compliance checking and reporting","Create security automation documentation and runbooks"],cost:"Included with NinjaOne license",hrs:12}
};

module.exports = D2;
